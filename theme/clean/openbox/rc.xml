<?xml version="1.0" encoding="UTF-8"?>
<openbox_config>

  <!-- Screen resistance settings -->
  <resistance>
    <strength>10</strength>
    <screen_edge_strength>20</screen_edge_strength>
  </resistance>

  <!-- Window focus rules -->
  <focus>
    <focusNew>yes</focusNew>
    <followMouse>no</followMouse>
    <focusLast>yes</focusLast>
    <underMouse>no</underMouse>
    <focusDelay>200</focusDelay>
    <raiseOnFocus>no</raiseOnFocus>
  </focus>

  <!-- Window placement rules -->
  <placement>
    <policy>Smart</policy>
    <center>yes</center>
    <monitor>Any</monitor>
    <primaryMonitor>1</primaryMonitor>
  </placement>

  <!-- Theme and font settings -->
  <theme>
    <name>Arc-Darker</name>
    <titleLayout>DSLIMC</titleLayout>
    <keepBorder>yes</keepBorder>
    <animateIconify>no</animateIconify>

    <font place="ActiveWindow">
      <name>Sans</name>
      <size>10</size>
      <weight>Bold</weight>
      <slant>Normal</slant>
    </font>
    <font place="InactiveWindow">
      <name>Sans</name>
      <size>10</size>
      <weight>Normal</weight>
      <slant>Normal</slant>
    </font>
    <font place="MenuHeader">
      <name>Sans</name>
      <size>10</size>
      <weight>Normal</weight>
      <slant>Normal</slant>
    </font>
    <font place="MenuItem">
      <name>Sans</name>
      <size>10</size>
      <weight>Normal</weight>
      <slant>Normal</slant>
    </font>
    <font place="ActiveOnScreenDisplay">
      <name>Sans</name>
      <size>10</size>
      <weight>Normal</weight>
      <slant>Normal</slant>
    </font>
    <font place="InactiveOnScreenDisplay">
      <name>Sans</name>
      <size>10</size>
      <weight>Normal</weight>
      <slant>Normal</slant>
    </font>
  </theme>

  <!-- Desktop settings -->
  <desktops>
    <number>4</number>
    <firstdesk>1</firstdesk>
    <names>
      <name>1</name>
      <name>2</name>
      <name>3</name>
      <name>4</name>
    </names>
    <popupTime>875</popupTime>
  </desktops>

  <!-- Resize and window margins -->
  <resize>
    <drawContents>yes</drawContents>
    <popupShow>Nonpixel</popupShow>
    <popupPosition>Center</popupPosition>
    <popupFixedPosition>
      <x>10</x>
      <y>10</y>
    </popupFixedPosition>
  </resize>

  <margins>
    <top>0</top>
    <bottom>0</bottom>
    <left>0</left>
    <right>0</right>
  </margins>

  <!-- Dock settings -->
  <dock>
    <position>TopLeft</position>
    <floatingX>0</floatingX>
    <floatingY>0</floatingY>
    <noStrut>no</noStrut>
    <stacking>Above</stacking>
    <direction>Vertical</direction>
    <autoHide>no</autoHide>
    <hideDelay>300</hideDelay>
    <showDelay>300</showDelay>
    <moveButton>Middle</moveButton>
  </dock>

  <!-- Keyboard shortcuts -->
  <keyboard>
    <chainQuitKey>C-g</chainQuitKey>

    <!-- Desktop switching -->
    <keybind key="C-A-Left"><action name="GoToDesktop"><to>left</to><wrap>no</wrap></action></keybind>
    <keybind key="C-A-Right"><action name="GoToDesktop"><to>right</to><wrap>no</wrap></action></keybind>
    <keybind key="C-A-Up"><action name="GoToDesktop"><to>up</to><wrap>no</wrap></action></keybind>
    <keybind key="C-A-Down"><action name="GoToDesktop"><to>down</to><wrap>no</wrap></action></keybind>

    <!-- Send window to desktop -->
    <keybind key="S-A-Left"><action name="SendToDesktop"><to>left</to><wrap>no</wrap></action></keybind>
    <keybind key="S-A-Right"><action name="SendToDesktop"><to>right</to><wrap>no</wrap></action></keybind>
    <keybind key="S-A-Up"><action name="SendToDesktop"><to>up</to><wrap>no</wrap></action></keybind>
    <keybind key="S-A-Down"><action name="SendToDesktop"><to>down</to><wrap>no</wrap></action></keybind>

    <!-- Direct desktop switching -->
    <keybind key="W-F1"><action name="GoToDesktop"><to>1</to></action></keybind>
    <keybind key="W-F2"><action name="GoToDesktop"><to>2</to></action></keybind>
    <keybind key="W-F3"><action name="GoToDesktop"><to>3</to></action></keybind>
    <keybind key="W-F4"><action name="GoToDesktop"><to>4</to></action></keybind>

    <!-- Show desktop toggle -->
    <keybind key="W-d"><action name="ToggleShowDesktop"/></keybind>

    <!-- Window management shortcuts -->
    <keybind key="A-F4"><action name="Close"/></keybind>
    <keybind key="A-F5"><action name="Iconify"/></keybind>
    <keybind key="A-F6"><action name="ToggleMaximize"/></keybind>
    <keybind key="A-Escape"><action name="Lower"/><action name="FocusToBottom"/><action name="Unfocus"/></keybind>
    <keybind key="A-space"><action name="ShowMenu"><menu>client-menu</menu></action></keybind>

    <!-- Window switching -->
    <keybind key="A-Tab">
      <action name="NextWindow">
        <finalactions><action name="Focus"/><action name="Raise"/><action name="Unshade"/></finalactions>
      </action>
    </keybind>
    <keybind key="A-S-Tab">
      <action name="PreviousWindow">
        <finalactions><action name="Focus"/><action name="Raise"/><action name="Unshade"/></finalactions>
      </action>
    </keybind>
    <keybind key="C-A-Tab">
      <action name="NextWindow"><panels>yes</panels><desktop>yes</desktop>
        <finalactions><action name="Focus"/><action name="Raise"/><action name="Unshade"/></finalactions>
      </action>
    </keybind>

    <!-- Arrow-based window cycling -->
    <keybind key="W-S-Right"><action name="DirectionalCycleWindows"><direction>right</direction></action></keybind>
    <keybind key="W-S-Left"><action name="DirectionalCycleWindows"><direction>left</direction></action></keybind>
    <keybind key="W-S-Up"><action name="DirectionalCycleWindows"><direction>up</direction></action></keybind>
    <keybind key="W-S-Down"><action name="DirectionalCycleWindows"><direction>down</direction></action></keybind>

    <!-- Application launching -->
    <keybind key="W-f">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>File Manager</name></startupnotify>
      <command>x-file-manager</command></action>
    </keybind>
    <keybind key="W-t">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>Terminal</name></startupnotify>
      <command>x-terminal-emulator</command></action>
    </keybind>
    <keybind key="W-w">
      <action name="Execute"><startupnotify><enabled>true</enabled><name>Web Browser</name></startupnotify>
      <command>x-www-browser</command></action>
    </keybind>
    <keybind key="W-l">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>Lock screen</name></startupnotify>
      <command>x-locker</command></action>
    </keybind>
    <keybind key="W-e">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>Editor</name></startupnotify>
      <command>x-text-editor</command></action>
    </keybind>
    <keybind key="W-h">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>Htop</name></startupnotify>
      <command>x-terminal-emulator -T 'htop task manager' -e htop</command></action>
    </keybind>
    <keybind key="W-r">
      <action name="Execute"><startupnotify><enabled>true</enabled><name>Rofi</name></startupnotify>
      <command>sh -c 'rofi -show drun'</command></action>
    </keybind>
    <keybind key="W-v">
      <action name="Execute"><startupnotify><enabled>true</enabled><name>Volume</name></startupnotify>
      <command>pavucontrol</command></action>
    </keybind>
    <keybind key="W-x">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>Logout</name></startupnotify>
      <command>obexit show</command></action>
    </keybind>
    <keybind key="W-Escape">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>xkill</name></startupnotify>
      <command>xkill</command></action>
    </keybind>

    <!-- Screenshot -->
    <keybind key="Print">
      <action name="Execute"><startupnotify><enabled>false</enabled><name>Screenshot</name></startupnotify>
      <command>scrot '%Y-%m-%d_%H-%M-%S_screenshot.png' -e 'mkdir -p "Pictures/Screenshots/"; mv "$f" "Pictures/Screenshots/"'</command></action>
    </keybind>

    <!-- Window tiling shortcuts -->
    <keybind key="W-Right"><action name="Unmaximize"/><action name="MoveResizeTo"><width>50%</width><height>100%</height><x>0</x><y>0</y></action></keybind>
    <keybind key="W-Left"><action name="Unmaximize"/><action name="MoveResizeTo"><width>50%</width><height>100%</height><x>0</x><y>0</y></action></keybind>
    <keybind key="W-Down"><action name="Unmaximize"/><action name="MoveResizeTo"><width>100%</width><height>50%</height><x>0</x><y>0</y></action></keybind>
    <keybind key="W-Up"><action name="Unmaximize"/><action name="MoveResizeTo"><width>100%</width><height>50%</height><x>0</x><y>0</y></action></keybind>

    <keybind key="W-A-Right"><action name="Unmaximize"/><action name="MoveResizeTo"><width>50%</width><height>50%</height><x>0</x><y>0</y></action></keybind>
    <keybind key="W-A-Left"><action name="Unmaximize"/><action name="MoveResizeTo"><width>50%</width><height>50%</height><x>0</x><y>0</y></action></keybind>
    <keybind key="W-A-Down"><action name="Unmaximize"/><action name="MoveResizeTo"><width>50%</width><height>50%</height><x>0</x><y>0</y></action></keybind>
    <keybind key="W-A-Up"><action name="Unmaximize"/><action name="MoveResizeTo"><width>50%</width><height>50%</height><x>0</x><y>0</y></action></keybind>

    <keybind key="A-r"><action name="Resize"/></keybind>
    <keybind key="A-m"><action name="Move"/></keybind>
  </keyboard>

  <!-- Mouse configuration -->
  <mouse>
    <dragThreshold>8</dragThreshold>
    <doubleClickTime>200</doubleClickTime>
    <screenEdgeWarpTime>400</screenEdgeWarpTime>
    <screenEdgeWarpMouse>false</screenEdgeWarpMouse>

    <!-- Window frame (Alt + mouse) -->
    <context name="Frame">
      <mousebind button="A-Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="A-Left" action="Click"><action name="Unshade"/></mousebind>
      <mousebind button="A-Left" action="Drag"><action name="Move"/></mousebind>

      <mousebind button="A-Right" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="A-Right" action="Drag"><action name="Resize"/></mousebind>

      <mousebind button="A-Middle" action="Press"><action name="Lower"/><action name="FocusToBottom"/><action name="Unfocus"/></mousebind>

      <mousebind button="A-Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="A-Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
      <mousebind button="C-A-Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="C-A-Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
      <mousebind button="A-S-Up" action="Click"><action name="SendToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="A-S-Down" action="Click"><action name="SendToDesktop"><to>next</to></action></mousebind>
    </context>

    <!-- Titlebar actions -->
    <context name="Titlebar">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Left" action="Drag"><action name="Move"/></mousebind>
      <mousebind button="Left" action="DoubleClick"><action name="ToggleMaximize"/></mousebind>

      <mousebind button="Middle" action="Press"><action name="Lower"/><action name="FocusToBottom"/><action name="Unfocus"/></mousebind>

      <mousebind button="Up" action="Click">
        <action name="if"><shaded>no</shaded><then><action name="Shade"/><action name="FocusToBottom"/><action name="Unfocus"/><action name="Lower"/></then></action>
      </mousebind>
      <mousebind button="Down" action="Click">
        <action name="if"><shaded>yes</shaded><then><action name="Unshade"/><action name="Raise"/></then></action>
      </mousebind>

      <mousebind button="Right" action="Press">
        <action name="Focus"/><action name="Raise"/>
        <action name="ShowMenu"><menu>client-menu</menu></action>
      </mousebind>
    </context>

    <!-- Titlebar buttons and corners -->
    <context name="Titlebar Top Right Bottom Left TLCorner TRCorner BRCorner BLCorner">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Middle" action="Press"><action name="Lower"/><action name="FocusToBottom"/><action name="Unfocus"/></mousebind>
      <mousebind button="Right" action="Press">
        <action name="Focus"/><action name="Raise"/>
        <action name="ShowMenu"><menu>client-menu</menu></action>
      </mousebind>
    </context>

    <!-- Resize edges -->
    <context name="Top">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Left" action="Drag"><action name="Resize"><edge>top</edge></action></mousebind>
    </context>
    <context name="Left">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Left" action="Drag"><action name="Resize"><edge>left</edge></action></mousebind>
    </context>
    <context name="Right">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Left" action="Drag"><action name="Resize"><edge>right</edge></action></mousebind>
    </context>
    <context name="Bottom">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Left" action="Drag"><action name="Resize"><edge>bottom</edge></action></mousebind>
      <mousebind button="Middle" action="Press"><action name="Lower"/><action name="FocusToBottom"/><action name="Unfocus"/></mousebind>
      <mousebind button="Right" action="Press">
        <action name="Focus"/><action name="Raise"/>
        <action name="ShowMenu"><menu>client-menu</menu></action>
      </mousebind>
    </context>

    <!-- Resize corners -->
    <context name="TRCorner BRCorner TLCorner BLCorner">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Left" action="Drag"><action name="Resize"/></mousebind>
    </context>

    <!-- Client area -->
    <context name="Client">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Middle" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Right" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
    </context>

    <!-- Window icon -->
    <context name="Icon">
      <mousebind button="Left" action="Press">
        <action name="Focus"/><action name="Raise"/><action name="Unshade"/>
        <action name="ShowMenu"><menu>client-menu</menu></action>
      </mousebind>
      <mousebind button="Right" action="Press">
        <action name="Focus"/><action name="Raise"/>
        <action name="ShowMenu"><menu>client-menu</menu></action>
      </mousebind>
    </context>

    <!-- Omnipresent toggle -->
    <context name="AllDesktops">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Left" action="Click"><action name="ToggleOmnipresent"/></mousebind>
    </context>

    <!-- Shade / iconify / maximize / close buttons -->
    <context name="Shade">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Left" action="Click"><action name="ToggleShade"/></mousebind>
    </context>
    <context name="Iconify">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
      <mousebind button="Left" action="Click"><action name="Iconify"/></mousebind>
    </context>
    <context name="Maximize">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Middle" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Right" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Left" action="Click"><action name="ToggleMaximize"/></mousebind>
      <mousebind button="Middle" action="Click"><action name="ToggleMaximize"><direction>vertical</direction></action></mousebind>
      <mousebind button="Right" action="Click"><action name="ToggleMaximize"><direction>horizontal</direction></action></mousebind>
    </context>
    <context name="Close">
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/><action name="Unshade"/></mousebind>
      <mousebind button="Left" action="Click"><action name="Close"/></mousebind>
    </context>

    <!-- Desktop background -->
    <context name="Desktop">
      <mousebind button="Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
      <mousebind button="A-Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="A-Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
      <mousebind button="C-A-Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="C-A-Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
      <mousebind button="Left" action="Press"><action name="Focus"/><action name="Raise"/></mousebind>
    </context>

    <!-- Root window menus -->
    <context name="Root">
      <mousebind button="Middle" action="Press"><action name="ShowMenu"><menu>client-list-combined-menu</menu></action></mousebind>
      <mousebind button="Right" action="Press"><action name="ShowMenu"><menu>root-menu</menu></action></mousebind>
    </context>

    <!-- During move/resize -->
    <context name="MoveResize">
      <mousebind button="Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
      <mousebind button="A-Up" action="Click"><action name="GoToDesktop"><to>previous</to></action></mousebind>
      <mousebind button="A-Down" action="Click"><action name="GoToDesktop"><to>next</to></action></mousebind>
    </context>
  </mouse>

  <!-- Menu configuration -->
  <menu>
    <file>menu.xml</file>
    <hideDelay>200</hideDelay>
    <middle>no</middle>
    <submenuShowDelay>100</submenuShowDelay>
    <submenuHideDelay>400</submenuHideDelay>
    <applicationIcons>yes</applicationIcons>
    <manageDesktops>yes</manageDesktops>
  </menu>

  <!-- Application-specific rules -->
  <applications>
    <application class="*">
      <focus>yes</focus>
    </application>
    <application name="obconf">
      <size><width>33%</width><height>50%</height></size>
    </application>
    <application name="mpv">
      <position force="yes"><x>center</x><y>center</y></position>
      <size><width>80%</width><height>80%</height></size>
    </application>
  </applications>

</openbox_config>
